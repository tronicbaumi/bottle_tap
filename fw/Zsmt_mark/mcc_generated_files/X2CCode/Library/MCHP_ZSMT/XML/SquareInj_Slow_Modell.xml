<?xml version="1.0" encoding="utf-8"?><!--V.0.29--><ControlBlock BlockId="4008" BlockName="SquareInj_Slow_Modell" LibraryName="MCHP_ZSMT" Author="rkothbauer" Revision="1.0" DateCreated="2010-10-14" DateLastChange="2019-09-23" Prompt="SquareInj_Slow_Modell" Order="0" SampleTimeFactor="1" TexFile="" LibraryType="INTERNAL" PreNameSpace="at.lcm.x2c" DefaultImplementation="FiP16" DirectFeedThrough="true" ParameterId="0" IsStaticId="false" IsConversionOnTarget="false" TaskLabel=""><BlockLicense Type="None"><CopyrightStatement></CopyrightStatement><LicenseStatement></LicenseStatement><Header>This file is part of X2C. http://www.mechatronic-simulation.org/
$LastChangedRevision$</Header></BlockLicense><Description>BE AWARE: This Block needs the SquareInjection_Fast-Block to work properly!!</Description><Mask Name=""><InportContainer><MaskInport Name="dphi"><Description>angle error input signal</Description><ConnectedOutport Name=""><BlockLink Name=""></BlockLink></ConnectedOutport></MaskInport><MaskInport Name="phi0"><Description>initial rotor angle Value which is preloaded at rising edge of Enable signal..</Description><ConnectedOutport Name=""><BlockLink Name=""></BlockLink></ConnectedOutport></MaskInport><MaskInport Name="n0"><Description>initial speed preloaded at rising edge of Enable signal</Description><ConnectedOutport Name=""><BlockLink Name=""></BlockLink></ConnectedOutport></MaskInport><MaskInport Name="Enable"><Description>Enable == 0: Deactivation of PLL functionality; Angle-Output is set input phi0; SYNC-Output toggles between 0 and 1;
Enable 0-&gt;1: Preload of integral parts of PI and uI
Enable == 1: Activation of this block</Description><ConnectedOutport Name=""><BlockLink Name=""></BlockLink></ConnectedOutport></MaskInport></InportContainer><OutportContainer><MaskOutport Name="phi"><Description>calculated electrical rotor angle</Description></MaskOutport><MaskOutport Name="Sync"><Description>Sync Signal:
For Synchronization of HF-Injection with SlowTaskISR. Synchronization is done in SquareInjection_Fast-Block.</Description></MaskOutport><MaskOutport Name="speed"><Description></Description></MaskOutport></OutportContainer><ParameterContainer><MaskParameter Name="n_max" Prompt="n_max [rpm]"><Description>Maximum (mechanical) speed</Description><MaskDouble><Value><Numeric>0.0</Numeric></Value><DefaultValue><Numeric>0.0</Numeric></DefaultValue></MaskDouble></MaskParameter><MaskParameter Name="p" Prompt="p (Number of Pole Pairs)"><Description>Number of pole pairs</Description><MaskDouble><Value><Numeric>1.0</Numeric></Value><DefaultValue><Numeric>1.0</Numeric></DefaultValue></MaskDouble></MaskParameter><MaskParameter Name="ts_fact" Prompt="Sample Time Multiplier"><Description>Multiplication factor of base sampling time (in integer
format)</Description><MaskDouble><Value><Numeric>4.0</Numeric></Value><DefaultValue><Numeric>4.0</Numeric></DefaultValue></MaskDouble></MaskParameter><MaskParameter Name="I_max" Prompt="I_max[A]"><Description>Normalization Value of Currents</Description><MaskDouble><Value><Numeric>0.0</Numeric></Value><DefaultValue><Numeric>0.0</Numeric></DefaultValue></MaskDouble></MaskParameter><MaskParameter Name="Jp" Prompt="Moment of Inertia [kg*m^2]"><Description>Moment of Inertia [kg*m^2]</Description><MaskDouble><Value><Numeric>0.0</Numeric></Value><DefaultValue><Numeric>0.0</Numeric></DefaultValue></MaskDouble></MaskParameter><MaskParameter Name="Keps" Prompt="HF-Current Amplitude[A]"><Description>Error Current due to HF-Injection into wrong direction</Description><MaskDouble><Value><Numeric>0.0</Numeric></Value><DefaultValue><Numeric>0.0</Numeric></DefaultValue></MaskDouble></MaskParameter><MaskParameter Name="rho" Prompt="tripple observer-pole [rad/s]"><Description>placement of Observer pole. The greater the pole is chosen, estimation of angle is done more dynamically</Description><MaskDouble><Value><Numeric>0.0</Numeric></Value><DefaultValue><Numeric>0.0</Numeric></DefaultValue></MaskDouble></MaskParameter><MaskParameter Name="method" Prompt="discretization method"><Description>method of discretization of used LTI systems (PI, I)</Description><MaskComboBox><Value><String>zoh</String></Value><DefaultValue><String>zoh</String></DefaultValue><Content><Item><String>zoh</String></Item><Item><String>tustin</String></Item></Content></MaskComboBox></MaskParameter><MaskParameter Name="selSpeedProp" Prompt="Select properties of Speed-Estimation"><Description>Select where to place the emphasis of the speed output: dynamic or noise</Description><MaskComboBox><Value><String></String></Value><DefaultValue><String>less-noise</String></DefaultValue><Content><Item><String>high-dynamic-range</String></Item><Item><String>less-noise</String></Item></Content></MaskComboBox></MaskParameter></ParameterContainer><Visualizations><Visualization Name="ScilabXcos" Type="VisualizationScilabXcos"><ScriptDefineSection></ScriptDefineSection><ScriptPlotSection></ScriptPlotSection><ScriptStyle></ScriptStyle><BlockIconDefaultSize>[7 4]</BlockIconDefaultSize></Visualization><Visualization Name="Matlab" Type="VisualizationMatlab"><Command><Item></Item><Item>disp('\fontsize{12}PLL Model-based','texmode', 'on')</Item><Item></Item><Item>port_label('input',1,'\Delta \phi','texmode', 'on');</Item><Item>port_label('input',2,'\phi_0','texmode', 'on');</Item><Item>port_label('input',3,'n_0','texmode', 'on');</Item><Item>port_label('input',4,'Enable','texmode', 'on');</Item><Item></Item><Item>port_label('output',1,'\phi','texmode', 'on');</Item><Item>port_label('output',2,'Sync','texmode', 'on');</Item></Command></Visualization></Visualizations></Mask><ImplementationConfig><ExistingImplementationContainer><Implementation Id="1" Name="FiP16" FriendlyName="16 Bit Fixed Point" Author="rkothbauer" Revision="2.0" DateCreated="2010-10-14" DateLastChange="2019-05-16" CFileName="SquareInj_Slow_Modell_FiP16.c" HFileName="SquareInj_Slow_Modell_FiP16.h" UpdateEnabled="true" ChecksumCFile="" ChecksumHFile="" AllowEmptyLoadFnc="false"><Description>16 Bit Fixed Point Implementation</Description><InportContainer><ImplementationInport Name="dphi" DataType="INT16"></ImplementationInport><ImplementationInport Name="phi0" DataType="INT16"></ImplementationInport><ImplementationInport Name="n0" DataType="INT16"></ImplementationInport><ImplementationInport Name="Enable" DataType="BOOL"></ImplementationInport></InportContainer><OutportContainer><ImplementationOutport Name="phi" DataType="INT16"></ImplementationOutport><ImplementationOutport Name="Sync" DataType="INT16"></ImplementationOutport><ImplementationOutport Name="speed" DataType="INT16"></ImplementationOutport></OutportContainer><ParameterContainer><ImplementationParameter Name="b0" DataType="INT32" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Integral coefficient PI</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="b1" DataType="INT32" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Proportional coefficient PI</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="sfrb0" DataType="INT8" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Shift factor for PI coefficient b0</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="sfrb1" DataType="INT8" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Shift factor for PI coefficient b1</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="i_old" DataType="INT64" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Integrator value PI from previous cycle</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="enable_old" DataType="BOOL" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Enable value of previous cycle</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="a0_PT1" DataType="INT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>coefficient of discrete PT1 transfer-function</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="b0_PT1" DataType="INT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>coefficient of discrete PT1 transfer-function</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="b1_PT1" DataType="INT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>coefficient of discrete PT1 transfer-function</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="sfra_PT1" DataType="INT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>shift factor of according coefficient of discrete PT1 transfer-function</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="sfrb_PT1" DataType="INT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>shift factor of according coefficient of discrete PT1 transfer-function</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="dphiOld" DataType="INT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>storage of last angle error input value</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="filtDphi" DataType="INT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>stores value of last PT1 filtered angle error signal</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="b0_uI" DataType="INT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>coefficient of discrete uI transfer-function</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="sfr_uI" DataType="INT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>shift factor of coefficient of discrete uI transfer-function</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="i_old_uI" DataType="INT32" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>old uI integrator value</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="toggleState" DataType="INT16" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>stores current Sync-State! Sync-State is either 0 or 1!
Needed for sync-pulse generation!
</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="b0_I" DataType="INT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>coefficient of discrete I transfer-function</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="sfr_I" DataType="INT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>shift factor of coefficient of discrete uI transfer-function</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="i_old_I" DataType="INT32" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>old uI integrator value</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="rawSpeed" DataType="INT8" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>if true, the input to the uIntegrator is the signal given to Speed output
if false, the output of the Integrator is the signal given to Speed output</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="vGain" DataType="INT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>proportional gain value</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="sfrGain" DataType="INT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>shiftFactor of proportional gain</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="b1_I" DataType="INT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>coefficient of discrete I transfer-function</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="b1_uI" DataType="INT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>coefficient of discrete uI transfer-function</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="sfrb1_I" DataType="INT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description></Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="sfrb1_uI" DataType="INT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description></Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter></ParameterContainer><Conversion Type="JavaScript" Language="JavaScript"></Conversion><FunctionLink Status="false" BlockName="" ImplementationName=""></FunctionLink></Implementation></ExistingImplementationContainer><UsedImplementation></UsedImplementation></ImplementationConfig></ControlBlock>
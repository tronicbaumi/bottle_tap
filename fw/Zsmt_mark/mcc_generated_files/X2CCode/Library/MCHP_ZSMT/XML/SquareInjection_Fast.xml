<?xml version="1.0" encoding="utf-8"?><!--V.0.29--><ControlBlock BlockId="4009" BlockName="SquareInjection_Fast" LibraryName="MCHP_ZSMT" Author="rkothbauer" Revision="1.0" DateCreated="2013-02-28" DateLastChange="2019-09-23" Prompt="SquareInjection_Fast" Order="0" SampleTimeFactor="1" TexFile="SquareInjection_Fast_Info.tex" LibraryType="INTERNAL" PreNameSpace="at.lcm.x2c" DefaultImplementation="FiP16" DirectFeedThrough="true" ParameterId="0" IsStaticId="false" IsConversionOnTarget="false" TaskLabel=""><BlockLicense Type=""><CopyrightStatement></CopyrightStatement><LicenseStatement></LicenseStatement><Header></Header></BlockLicense><Description>* AngleDetection: calculates rotor-angle at init-time;
* Enable Sequence: realizes an adjustable Delay-Sequence for enabling PLL and controller;
* Voltage Injection: injects a square-wave voltage signal with fPWM/2 and adjustable amplitude;

BE AWARE:
This Block needs the SquareInjection_Slow-Block to work properly!</Description><Mask Name=""><InportContainer><MaskInport Name="Ix"><Description>d-current in estimated refercence frame x,y</Description><ConnectedOutport Name=""><BlockLink Name=""></BlockLink></ConnectedOutport></MaskInport><MaskInport Name="Iy"><Description>q-current in estimated refercence frame x,y</Description><ConnectedOutport Name=""><BlockLink Name=""></BlockLink></ConnectedOutport></MaskInport><MaskInport Name="Sync"><Description>synchronization with slowTaskISR;
First detected rising egde of the Sync-input activates the voltage injection.</Description><ConnectedOutport Name=""><BlockLink Name=""></BlockLink></ConnectedOutport></MaskInport><MaskInport Name="EnableInj"><Description>Enables and disables injection of HF-voltage. 
Usually used in combination with sensorless bEmf-algortihms @higher speeds. For applications solely controlled by hf-injection, set this input to constant 1.

EnableInj = 0: hf-voltage injection is disabled. Ud and angle-error dPhi are set to zero.
EnableInj != 0:  hf-voltage is enabled.</Description><ConnectedOutport Name=""><BlockLink Name=""></BlockLink></ConnectedOutport></MaskInport><MaskInport Name="Enable"><Description>Enable = 0: Outputs are zero.
Enable != 0: Initial rotor angle is determined, PLL and controller enabled.</Description><ConnectedOutport Name=""><BlockLink Name=""></BlockLink></ConnectedOutport></MaskInport></InportContainer><OutportContainer><MaskOutport Name="Ud"><Description>This Output has 2 operational meanings:
@startUp: ud is the amplitude of the voltage-phasor for the calculation of the initial rotor angle.
@Injection: once Injection is activated, ud is the amplitude of the square-wave voltage injected. </Description></MaskOutport><MaskOutport Name="PhiInit"><Description>Initial rotor angle</Description></MaskOutport><MaskOutport Name="EnablePLL"><Description>Enable signal for PLL</Description></MaskOutport><MaskOutport Name="EnableCtrl"><Description>Enable signal for motor-controllers</Description></MaskOutport><MaskOutport Name="dPhi"><Description>Angle-error of the estimated reference frame x,y. k\epsilon \sin (2\Delta\varphi)</Description></MaskOutport></OutportContainer><ParameterContainer><MaskParameter Name="VoltPhasor" Prompt="Amplitude รป of Voltage Pulse"><Description>Angle Detection: Amplitdue of voltage pulses used for determination of initial rotor anlge</Description><MaskDouble><Value><Numeric>0.0</Numeric></Value><DefaultValue><Numeric>0.0</Numeric></DefaultValue></MaskDouble></MaskParameter><MaskParameter Name="T1" Prompt="start time T1 [ms]"><Description>Angle Detection: Time after enable of first voltage-pulse</Description><MaskDouble><Value><Numeric>1.0</Numeric></Value><DefaultValue><Numeric>1.0</Numeric></DefaultValue></MaskDouble></MaskParameter><MaskParameter Name="deltaT" Prompt="periode Tp [ms]"><Description>Angle Detection: Time inbetween voltage pulses</Description><MaskDouble><Value><Numeric>1.0</Numeric></Value><DefaultValue><Numeric>1.0</Numeric></DefaultValue></MaskDouble></MaskParameter><MaskParameter Name="Tpulse" Prompt="pulse-time Ton [samples]"><Description>Angle Detection: Time of voltage-pulse to be at the given amplitude</Description><MaskDouble><Value><Numeric>4.0</Numeric></Value><DefaultValue><Numeric>4.0</Numeric></DefaultValue></MaskDouble></MaskParameter><MaskParameter Name="DelayPLL" Prompt="Time Delay for enabling PLL [s]"><Description>Time delay for enabling PLL</Description><MaskDouble><Value><Numeric>0.0</Numeric></Value><DefaultValue><Numeric>0.0</Numeric></DefaultValue></MaskDouble></MaskParameter><MaskParameter Name="DelayCtrl" Prompt="Time Delay for enabling Controllers [s]"><Description>Time Delay for enabling PLL [s]</Description><MaskDouble><Value><Numeric>0.0</Numeric></Value><DefaultValue><Numeric>0.0</Numeric></DefaultValue></MaskDouble></MaskParameter><MaskParameter Name="uInj" Prompt="Square-wave Amplitude [V]"><Description>voltage amplitude of injected square wave</Description><MaskDouble><Value><Numeric>0.0</Numeric></Value><DefaultValue><Numeric>0.0</Numeric></DefaultValue></MaskDouble></MaskParameter><MaskParameter Name="uDCmax" Prompt="Normalization value of UDC voltage"><Description>Normalization of Udc link voltage</Description><MaskDouble><Value><Numeric>0.0</Numeric></Value><DefaultValue><Numeric>0.0</Numeric></DefaultValue></MaskDouble></MaskParameter><MaskParameter Name="ts_fact" Prompt="Sample Time Multiplier"><Description></Description><MaskDouble><Value><Numeric>1.0</Numeric></Value><DefaultValue><Numeric>1.0</Numeric></DefaultValue></MaskDouble></MaskParameter></ParameterContainer><Visualizations><Visualization Name="Matlab" Type="VisualizationMatlab"><Command><Item>patch([0 0 1 0], [0 0 0 0.2 ], [0.91 0.84 0])</Item><Item></Item><Item>port_label('input',1,'I_x','texmode','on')</Item><Item>port_label('input',2,'I_y','texmode','on')</Item><Item>port_label('input',3,'Sync')</Item><Item>port_label('input',4,'Enable Inj')</Item><Item>port_label('input',5,'Enable')</Item><Item></Item><Item>port_label('output',1,'u_d','texmode','on')</Item><Item>port_label('output',2,'\phi_{INIT}','texmode','on')</Item><Item>port_label('output',3,'Enable PLL','texmode','on')</Item><Item>port_label('output',4,'Enable Ctrl','texmode','on')</Item><Item>port_label('output',5,'\Delta \phi','texmode','on')</Item></Command></Visualization></Visualizations></Mask><ImplementationConfig><ExistingImplementationContainer><Implementation Id="0" Name="FiP16" FriendlyName="FiP16" Author="rkothbauer" Revision="1.0" DateCreated="2013-02-28" DateLastChange="2019-05-10" CFileName="SquareInjection_Fast_FiP16.c" HFileName="SquareInjection_Fast_FiP16.h" UpdateEnabled="true" ChecksumCFile="" ChecksumHFile="" AllowEmptyLoadFnc="false"><Description></Description><InportContainer><ImplementationInport Name="Ix" DataType="INT16"></ImplementationInport><ImplementationInport Name="Iy" DataType="INT16"></ImplementationInport><ImplementationInport Name="Sync" DataType="INT16"></ImplementationInport><ImplementationInport Name="EnableInj" DataType="BOOL"></ImplementationInport><ImplementationInport Name="Enable" DataType="BOOL"></ImplementationInport></InportContainer><OutportContainer><ImplementationOutport Name="Ud" DataType="INT16"></ImplementationOutport><ImplementationOutport Name="PhiInit" DataType="INT16"></ImplementationOutport><ImplementationOutport Name="EnablePLL" DataType="BOOL"></ImplementationOutport><ImplementationOutport Name="EnableCtrl" DataType="BOOL"></ImplementationOutport><ImplementationOutport Name="dPhi" DataType="INT16"></ImplementationOutport></OutportContainer><ParameterContainer><ImplementationParameter Name="iUsAmp" DataType="INT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description></Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="tmp1" DataType="INT16" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description></Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="tmp3" DataType="INT16" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description></Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="tmp5" DataType="INT16" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description></Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="tmp6" DataType="INT16" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description></Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="tmp7" DataType="INT16" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description></Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="tmp2" DataType="INT16" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description></Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="tmp4" DataType="INT16" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description></Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="t_pulse" DataType="INT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description></Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="t1" DataType="INT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description></Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="deltaT" DataType="INT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description></Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="delayPLL" DataType="UINT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Time delay for PLL</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="delayCtrl" DataType="UINT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Time delay for Controllers</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="foundPhiInit" DataType="INT16" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>flag that signals whether initial rotor angle was already calculated or not</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="toggleStatus" DataType="INT16" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>holdes current state of square-wave -ud or +ud</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="uInjAmp" DataType="INT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Amplitude of injected square wave voltage</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="iy0" DataType="INT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>current values in estimated y coordinate
</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="actInj" DataType="INT16" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>flag that signals whether injection is activated or deactiveted</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="iy1" DataType="INT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description></Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="iy2" DataType="INT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description></Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="iy3" DataType="INT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description></Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="iy4" DataType="INT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description></Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter></ParameterContainer><Conversion Type="JavaScript" Language="JavaScript"></Conversion><FunctionLink Status="false" BlockName="" ImplementationName=""></FunctionLink></Implementation></ExistingImplementationContainer><UsedImplementation></UsedImplementation></ImplementationConfig></ControlBlock>